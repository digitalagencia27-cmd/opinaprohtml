<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Redirecionando...</title>

  <script>
    (function () {
      const checkoutLink = "https://go.tribopay.com.br/s33fs";
      const emailDomains = [
        "outlook.com", "hotmail.com", "yahoo.com", "icloud.com",
        "protonmail.com", "bol.com.br", "live.com", "aol.com", "terra.com.br"
      ];

      const urlParams = new URLSearchParams(window.location.search);
      const email = urlParams.get("email");

      const isValidEmail = email && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);

      if (isValidEmail) {
        const user = email.split("@")[0];
        const newDomain = emailDomains[Math.floor(Math.random() * emailDomains.length)];
        urlParams.set("email", `${user}@${newDomain}`);
        // PASSA OS PARÂMETROS SEM DUPLICAR
        window.location.replace(`${checkoutLink}?${urlParams.toString()}`);
      } else {
        // REMOVE APENAS O EMAIL INVÁLIDO, MANTÉM OUTROS PARÂMETROS
        urlParams.delete("email");
        if (urlParams.toString()) {
          window.location.replace(`${checkoutLink}?${urlParams.toString()}`);
        } else {
          window.location.replace(checkoutLink);
        }
      }
    })();
  </script>

  <noscript>
    <meta http-equiv="refresh" content="0;url=https://go.tribopay.com.br/s33fs">
  </noscript>
</head>
<body>
       <!-- Clarity-->
       <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "tsw6obkk55");
</script>
<!-- Backredirect-->
      <script>
      // ALTERE O LINK PARA A PÁGINA QUE QUISER MOSTRAR QUANDO O USUÁRIO TENTAR SAIR
      const link = 'https://opina-pro-oficial.vercel.app/back1';

      function setBackRedirect(url) {
        let urlBackRedirect = url;
        urlBackRedirect = urlBackRedirect =
          urlBackRedirect.trim() +
          (urlBackRedirect.indexOf('?') > 0 ? '&' : '?') +
          document.location.search.replace('?', '').toString();

        history.pushState({}, '', location.href);
        history.pushState({}, '', location.href);
        history.pushState({}, '', location.href);

        window.addEventListener('popstate', () => {
          console.log('onpopstate', urlBackRedirect);
          setTimeout(() => {
            location.href = urlBackRedirect;
          }, 1);
        });
      }

      setBackRedirect(link);
    </script>
</body>
</html>
